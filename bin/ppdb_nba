#!/usr/bin/env python
from argparse import ArgumentParser
from ppdb_nba import *

def import_incremental(args,config):
    print("import incremental")

def import_to_current(args,config):
    print("import to current")

def main():
    parser = ArgumentParser(usage='ppdb_nba --source sourcename /path/file1 /path/file2 ...'
                                           '\n\nPreprocessing data to create incremental updates or posting it directly'
                                           '\nto elastic search')

    parser.add_argument('--source', help='Name of the data source', nargs=1)
    parser.add_argument('--current', action='store_true', help='Import data directly to current database')
    parser.add_argument('files', help='One or more json data files', nargs='+', default=[])
    args = parser.parse_args()

    sourceconfig = cfg.get('sources')
    print("%r" % (sourceconfig))
    exit()
    srcconfig = cfg.get('sources').get(args.source, False)
#    if not srcconfig:
#        print('Bron "{source}" bestaat niet, kies een van de onderstaande bronnen'.format(source=source))
#        sources = cfg.get('sources', None)
#        if (sources) :
#            print("\n".join(sources))
#        exit(2)

    if (args.current):
        import_to_current(args, srcconfig)
    else:
        import_incremental(args, srcconfig)

if __name__ == "__main__":
    main()